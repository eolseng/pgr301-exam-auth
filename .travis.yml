language: java
jdk: openjdk11

services:
  - docker

env:
  global:
    # Disable Google Cloud SDK prompts
    - CLOUDSDK_CORE_DISABLE_PROMPTS=1

cache:
  directories:
    - ".autoconf"
    - "$HOME/.m2"
    - "$HOME/google-cloud-sdk/"
    - "$HOME/bin/terraform/"

before_install:
  # Update Docker to latest version
  - bash ./scripts/update_docker
  # Install Google Cloud SDK if not cached
  - bash ./scripts/install_gcloud
  # Use the downloaded SDK instead of pre-installed old version on Travis-CI
  - source $HOME/google-cloud-sdk/path.bash.inc

install:
  # Run the standard "install" script with '-T 1C' added for faster builds
  - mvn -T 1C install -DskipTests=true -Dmaven.javadoc.skip=true -B -V

script:
  # Run the standard "test" script with '-T 1C' added for faster builds
  - mvn -T 1C test -B
