language: java
jdk: openjdk11

services:
  - docker

# Caches Maven dependencies, Google Cloud SDK and Terraform
cache:
  directories:
    - ".autoconf"
    - "$HOME/.m2"
    - "$HOME/google-cloud-sdk/"
    - "$HOME/bin/terraform/"

before_install:
  # Update Docker to latest version
  - bash ./scripts/docker_update
  # Install Google Cloud SDK if not cached
  - bash ./scripts/install_gcloud
  # Use the downloaded SDK instead of pre-installed old version on Travis-CI
  - source $HOME/google-cloud-sdk/path.bash.inc

install:
  # Run unit and integration tests
  - mvn -T 1C verify